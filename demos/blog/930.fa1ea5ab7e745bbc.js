"use strict";(self.webpackChunkangular_blog=self.webpackChunkangular_blog||[]).push([[930],{3930:(zt,w,l)=>{l.r(w),l.d(w,{BlogModule:()=>wt});var p=l(6895),d=l(493),b=l(6858),m=l(9653),W=l(5601),E=l(6582),I=l(8538),t=l(4650),h=l(5473),S=l(9646),T=l(4004),J=l(8505);const V=(0,m.P1)(o=>o.router,o=>o.state.params),tt=(new h.El).create("BlogPost"),et=(0,m.P1)(tt.selectEntityMap,V,(o,a)=>a?.blogPostId&&o?.[a.blogPostId]?o[a.blogPostId]:null);var ot=l(529),F=l(9370);let q=(()=>{class o extends h.XD{constructor(e=new h.QB([])){super(e),this.aPluralizer=e}getResourceUrls(e,n){let i=this.knownHttpResourceUrls[e];if(!i){F.q.hasOwnProperty(e)&&(n=F.q[e]);const s=(0,h.Dl)(n);let c=e;"BlogPost"===e&&(c="blog");const u=`${s}/${c}/`.toLowerCase();console.log(u),i={entityResourceUrl:u,collectionResourceUrl:u},this.registerHttpResourceUrls({[e]:i})}return i}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(h.xc))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Y=(()=>{class o extends h.EJ{constructor(e,n,i){super("BlogPost",e,n),i.log("Created custom BlogPost EntityDataService")}addTagToBlogPost(e,n){return this.execute("PUT",`https://endevel-task.doc.endevel.cz/blog/${e}/add_tag/${n}/`)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(ot.eN),t.LFG(q),t.LFG(h.Yd))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),C=(()=>{class o{constructor(e,n,i){this.blogPostDataService=n,this.store=i,this.blogService=e.create("BlogPost"),this.loading$=this.blogService.loading$,this.blogs$=this.blogService.entities$,this.blogsCount$=this.blogService.count$,this.selectedBlog$=this.store.select(et).pipe((0,T.U)(s=>s||null))}getBlogPosts(){this.blogService.getAll()}getBlogPostById(e){return this.blogService.getByKey(e)}updateBlogPost(e){this.blogService.update(e)}addTagToBlogPost(e,n){return e&&n?(this.blogService.setLoaded(!1),this.blogService.setLoading(!0),this.blogPostDataService.addTagToBlogPost(e,n).pipe((0,J.b)(i=>{this.blogService.updateOneInCache(i),this.blogService.setLoading(!1),this.blogService.setLoaded(!0)}))):(0,S.of)(null)}dispatchCSBlogPostFetchByIdForEffect(e){return this.blogService.createEntityAction(h.WD.QUERY_BY_KEY,e)}dispatchCSBlogPostsFetchForEffect(){return this.blogService.createEntityAction(h.WD.QUERY_ALL)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(h.mL),t.LFG(Y),t.LFG(m.yh))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();var _=(()=>{return(o=_||(_={})).BLOG_MODULE_INIT="BLOG_MODULE_INIT",o.TAGS_LIST_REQUEST="TAGS_LIST_REQUEST",o.TAGS_LIST_RESPONSE="TAGS_LIST_RESPONSE",o.TAGS_LIST_FAILURE="TAGS_LIST_FAILURE",o.CREATE_TAG_REQUEST="CREATE_TAG_REQUEST",o.CREATE_TAG_RESPONSE="CREATE_TAG_RESPONSE",o.CREATE_TAG_FAILURE="CREATE_TAG_FAILURE",o.UPDATE_TAG_REQUEST="UPDATE_TAG_REQUEST",o.UPDATE_TAG_RESPONSE="UPDATE_TAG_RESPONSE",o.UPDATE_TAG_FAILURE="UPDATE_TAG_FAILURE",o.ADD_TAG_TO_BLOGPOST_REQUEST="ADD_TAG_TO_BLOGPOST_REQUEST",o.ADD_TAG_TO_BLOGPOST_RESPONSE="ADD_TAG_TO_BLOGPOST_RESPONSE",o.ADD_TAG_TO_BLOGPOST_FAILURE="ADD_TAG_TO_BLOGPOST_FAILURE",_;var o})();const r=(0,m.R7)({source:"[BLOG]",events:{[_.BLOG_MODULE_INIT]:(0,m.uZ)(),[_.TAGS_LIST_REQUEST]:(0,m.uZ)(),[_.TAGS_LIST_RESPONSE]:(o,a,e)=>({items:o,itemsById:a,total:e}),[_.TAGS_LIST_FAILURE]:o=>({error:o}),[_.CREATE_TAG_REQUEST]:o=>({newTag:o}),[_.CREATE_TAG_RESPONSE]:o=>({item:o}),[_.CREATE_TAG_FAILURE]:o=>({error:o}),[_.UPDATE_TAG_REQUEST]:o=>({proposedTag:o}),[_.UPDATE_TAG_RESPONSE]:o=>({updatedTag:o}),[_.UPDATE_TAG_FAILURE]:o=>({error:o}),[_.ADD_TAG_TO_BLOGPOST_REQUEST]:(o,a)=>({tagId:o,blogPostId:a}),[_.ADD_TAG_TO_BLOGPOST_RESPONSE]:o=>({item:o}),[_.ADD_TAG_TO_BLOGPOST_FAILURE]:o=>({error:o})}}),P=(0,m.Tz)({name:"tags",reducer:(0,m.Lq)({tags:[],tagsById:{},tagsTotal:null,loading:!1,errors:null},(0,m.on)(r.tags_list_request||r.create_tag_request||r.update_tag_request||r.add_tag_to_blogpost_request,o=>({...o,loading:!0})),(0,m.on)(r.tags_list_response,(o,{items:a,itemsById:e,total:n})=>({...o,loading:!1,tags:a,tagsById:e,tagsTotal:n})),(0,m.on)(r.create_tag_response||r.update_tag_response||r.add_tag_to_blogpost_response,o=>({...o,loading:!1})),(0,m.on)(r.create_tag_failure||r.tags_list_failure||r.update_tag_failure||r.add_tag_to_blogpost_failure,(o,{error:a})=>({...o,loading:!1,error:a})))});let Z=(()=>{class o{constructor(e){this.store=e,this.tags$=this.store.select(P.selectTags),this.tagsById$=this.store.select(P.selectTagsById),this.tagsTotal$=this.store.select(P.selectTagsTotal),this.tagsLoading$=this.store.select(P.selectLoading),this.tagsError$=this.store.select(P.selectErrors)}fetchTagsList(){this.store.dispatch(r.tags_list_request())}crateNewTag(e){this.store.dispatch(r.create_tag_request(e))}updateNewTag(e){this.store.dispatch(r.update_tag_request(e))}addTagToBlogPost(e,n){this.store.dispatch(r.add_tag_to_blogpost_request(e,n))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(m.yh))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var G=l(1135),L=l(8675),x=l(9841),M=l(1884),$=l(4782),at=l(3900);let A=(()=>{class o{constructor(e,n){this.blogPostCS=e,this.blogFacade=n,this.blogPostspaginationSize=5,this.selectedListPageSubject=new G.X(1),this.selectedListPage$=this.selectedListPageSubject.asObservable(),this.selectedBlogPostModeSubjecct=new G.X(I.tH.READ),this.selectedBlogPostMode$=this.selectedBlogPostModeSubjecct.asObservable(),this.editedBlogPostSubject=new G.X(null),this.editedBlogPost$=this.editedBlogPostSubject.asObservable(),this.tags$=this.blogFacade.tags$,this.tagsById$=this.blogFacade.tagsById$,this.blogPosts$=this.blogPostCS.blogs$.pipe((0,L.O)([]),(0,J.b)(i=>!i?.length&&this.blogPostCS.getBlogPosts())),this.selectedBlogPost$=this.blogPostCS.selectedBlog$,this.blogPostsCount$=this.blogPostCS.blogsCount$.pipe((0,L.O)(0)),this.listPage$=(0,x.a)(this.blogPostsCount$,this.selectedListPage$).pipe((0,M.x)(),(0,T.U)(([i,s])=>s),(0,$.d)({refCount:!0,bufferSize:1})),this.blogPostsPerPage$=(0,x.a)(this.blogPosts$,this.listPage$).pipe((0,at.w)(([i,s])=>(0,S.of)(this.paginateBlogPosts(i,s))),(0,$.d)({refCount:!0,bufferSize:1})),this.data$=(0,x.a)(this.blogPostCS.loading$,this.blogPostsCount$,this.blogPostsPerPage$,this.listPage$,this.tags$,this.tagsById$,this.selectedBlogPost$,this.editedBlogPost$,this.selectedBlogPostMode$).pipe((0,M.x)(),(0,T.U)(([i,s,c,u,Jt,qt,Yt,Mt,kt])=>({blogPostsLoading:i,blogPostsTotal:s,blogPostsPerPage:c,page:u,tags:Jt,tagsById:qt,selectedBlogPost:Yt,editedBlogPost:Mt,selectedBlogPostMode:kt})),(0,$.d)({refCount:!0,bufferSize:1}))}onChangePage(e){this.selectedListPageSubject.next(e),console.log(e)}updateBlogPost(e){this.blogPostCS.updateBlogPost(e)}addTagToBlogPost(e,n){this.blogFacade.addTagToBlogPost(e,n)}createNewTag(e){this.blogFacade.crateNewTag({name:e})}onSelectBlogPost(e=I.tH.READ){this.selectedBlogPostModeSubjecct.next(e)}paginateBlogPosts(e,n){return e?.length?e.slice((n-1)*this.blogPostspaginationSize,n*this.blogPostspaginationSize):[]}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(C),t.LFG(Z))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();var D=l(4859),f=l(3546),B=l(7331),st=l(8739),k=l(1572);function it(o,a){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw().$implicit,n=t.oxw(4).ngIf;t.xp6(1),t.hij(" ",n.tagsById[e].name," ")}}function lt(o,a){if(1&o&&(t.TgZ(0,"mat-chip"),t.YNc(1,it,2,1,"ng-container",1),t.qZA()),2&o){const e=a.$implicit,n=t.oxw(4).ngIf;t.xp6(1),t.Q6J("ngIf",n.tagsById[e])}}function ct(o,a){if(1&o&&(t.TgZ(0,"mat-card-content")(1,"mat-chip-list"),t.YNc(2,lt,2,1,"mat-chip",11),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngForOf",e.tags)}}function rt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",7)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),t._uU(4),t.qZA()(),t._UZ(5,"img",8),t.TgZ(6,"mat-card-content")(7,"p"),t._uU(8),t.qZA()(),t.TgZ(9,"mat-card-actions")(10,"button",9),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw(3);return t.KtG(c.onSelectBlogPost(s.id,c.EBlogModes.READ))}),t._uU(11," DETAIL "),t.qZA(),t.TgZ(12,"button",10),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw(3);return t.KtG(c.onSelectBlogPost(s.id,c.EBlogModes.EDIT))}),t._uU(13,"EDIT"),t.qZA()(),t.YNc(14,ct,3,1,"mat-card-content",1),t.qZA()()}if(2&o){const e=a.$implicit;t.xp6(4),t.Oqu(e.title),t.xp6(1),t.Q6J("src",e.thumbnail,t.LSH),t.xp6(3),t.Oqu(e.detail),t.xp6(6),t.Q6J("ngIf",e.tags.length)}}function gt(o,a){if(1&o){const e=t.EpF();t.YNc(0,rt,15,4,"div",4),t.TgZ(1,"div",5)(2,"mat-paginator",6),t.NdJ("page",function(i){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onSelectPage(i))}),t.qZA()()}if(2&o){const e=t.oxw().ngIf;t.Q6J("ngForOf",e.blogPostsPerPage),t.xp6(2),t.Q6J("length",e.blogPostsTotal)("pageSize",5)("hidePageSize",!0)}}function dt(o,a){1&o&&(t.TgZ(0,"div",12),t._UZ(1,"mat-spinner"),t.qZA())}function pt(o,a){if(1&o&&(t.ynx(0),t.YNc(1,gt,3,4,"ng-template",2),t.YNc(2,dt,2,0,"ng-template",null,3,t.W1O),t.BQk()),2&o){const e=a.ngIf,n=t.MAs(3);t.xp6(1),t.Q6J("ngIf",e.blogPostsPerPage&&!e.blogPostsLoading)("ngIfElse",n)}}let _t=(()=>{class o{constructor(e,n,i,s,c){this.http=e,this.bs=n,this.blogFacade=i,this.blogDataService=s,this.router=c,this.data$=this.blogDataService.data$,this.EBlogModes=I.tH}onSelectBlogPost(e,n=I.tH.READ){this.blogDataService.onSelectBlogPost(n),this.router.navigate(["/blog",e])}onSelectPage(e){this.blogDataService.onChangePage(e.pageIndex+1)}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(b.O),t.Y36(C),t.Y36(Z),t.Y36(A),t.Y36(E.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-blog-posts"]],decls:3,vars:3,consts:[[1,"row"],[4,"ngIf"],[3,"ngIf","ngIfElse"],["spinner",""],["class","offset-2 col-8 pb-5",4,"ngFor","ngForOf"],[1,"offset-3","col-6"],["aria-label","Select page",3,"length","pageSize","hidePageSize","page"],[1,"offset-2","col-8","pb-5"],["mat-card-image","","alt","",3,"src"],["mat-raised-button","","color","primary",3,"click"],["mat-stroked-button","","color","primary",3,"click"],[4,"ngFor","ngForOf"],[1,"col"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,pt,4,2,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.data$)))},dependencies:[p.sg,p.O5,D.lW,f.a8,f.dk,f.dn,f.n5,f.hq,f.G2,B.qn,B.HS,st.NW,k.Ou,p.Ov],styles:["mat-card-actions[_ngcontent-%COMP%]{padding-left:.5rem}  .mat-paginator-container{justify-content:center!important}"],changeDetection:0}),o})();var y=l(7392),R=l(6338);function ut(o,a){if(1&o&&(t.TgZ(0,"mat-icon",3),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.icon)}}const mt=function(o){return{"fw-bold":o}};let ht=(()=>{class o{constructor(){this.text="",this.icon="",this.isBold=!1,this.onClicked=new t.vpe}onClick(){this.emitData?this.onClicked.emit(this.emitData):this.onClicked.emit()}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-sidebar-list-item"]],inputs:{text:"text",icon:"icon",isBold:"isBold",emitData:"emitData"},outputs:{onClicked:"onClicked"},decls:4,vars:5,consts:[[3,"click"],["mat-list-icon","",4,"ngIf"],[3,"ngClass"],["mat-list-icon",""]],template:function(e,n){1&e&&(t.TgZ(0,"mat-list-item",0),t.NdJ("click",function(){return n.onClick()}),t.YNc(1,ut,2,1,"mat-icon",1),t.TgZ(2,"div",2),t._uU(3),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("ngIf",n.icon),t.xp6(1),t.Q6J("ngClass",t.VKq(3,mt,n.isBold)),t.xp6(1),t.hij(" ",n.text," "))},dependencies:[p.mk,p.O5,y.Hw,R.Tg,R.Nh],styles:["[_nghost-%COMP%]{cursor:pointer}"],changeDetection:0}),o})();function ft(o,a){if(1&o&&t._UZ(0,"app-sidebar-list-item",3),2&o){const e=a.$implicit;t.Q6J("text",e.name)("icon","folder")("emitData",e.id)}}function Tt(o,a){if(1&o&&(t.TgZ(0,"mat-card")(1,"h2"),t._uU(2,"Tags"),t.qZA(),t.TgZ(3,"mat-list"),t.YNc(4,ft,1,3,"app-sidebar-list-item",1),t.qZA(),t.TgZ(5,"h2",2),t._uU(6,"Dev info"),t.qZA(),t.TgZ(7,"div")(8,"div")(9,"strong"),t._uU(10,"Approach: "),t.qZA(),t._uU(11,"declarative (reactive RxJS)"),t.qZA(),t.TgZ(12,"div")(13,"strong"),t._uU(14,"Forms: "),t.qZA(),t._uU(15,"reactive"),t.qZA(),t.TgZ(16,"div")(17,"strong"),t._uU(18,"Archit.: "),t.qZA(),t._uU(19,"lazy loading, containers, redux"),t.qZA(),t.TgZ(20,"div")(21,"strong"),t._uU(22,"Redux: "),t.qZA(),t._uU(23,"@ngrx/store, @ngrx/data, @ngrx/router, @ngrx/entity"),t.qZA()()()),2&o){const e=a.ngIf;t.xp6(4),t.Q6J("ngForOf",e.tags)}}let Bt=(()=>{class o{constructor(e,n,i,s){this.http=e,this.bs=n,this.blogFacade=i,this.blogDataService=s,this.data$=this.blogDataService.data$}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(b.O),t.Y36(C),t.Y36(Z),t.Y36(A))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-blog-sidebar"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"text","icon","emitData",4,"ngFor","ngForOf"],[1,"pad"],[3,"text","icon","emitData"]],template:function(e,n){1&e&&(t.YNc(0,Tt,24,1,"mat-card",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.data$))},dependencies:[p.sg,p.O5,ht,f.a8,R.i$,p.Ov],styles:["h2.pad[_ngcontent-%COMP%]{padding-top:2.5rem}strong[_ngcontent-%COMP%]{padding-right:5px}"],changeDetection:0}),o})();var N=l(3848);function Pt(o,a){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw().$implicit,n=t.oxw(2).ngIf;t.xp6(1),t.hij(" ",n.tagsById[e].name," ")}}function St(o,a){if(1&o&&(t.TgZ(0,"mat-chip"),t.YNc(1,Pt,2,1,"ng-container",0),t.qZA()),2&o){const e=a.$implicit,n=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf",n.tagsById[e])}}function At(o,a){if(1&o&&(t.TgZ(0,"mat-card-content")(1,"mat-chip-list"),t.YNc(2,St,2,1,"mat-chip",5),t.qZA()()),2&o){const e=t.oxw().ngIf;t.xp6(2),t.Q6J("ngForOf",null==e.selectedBlogPost?null:e.selectedBlogPost.tags)}}function vt(o,a){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"mat-spinner"),t.qZA())}function Ct(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-card")(2,"div",1)(3,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onGoBack())}),t._uU(4,"ZP\u011aT"),t.qZA()(),t.TgZ(5,"mat-card-header")(6,"mat-card-title"),t._uU(7),t.qZA()(),t._UZ(8,"img",3),t.TgZ(9,"mat-card-content")(10,"p"),t._uU(11),t.qZA()(),t.YNc(12,At,3,1,"mat-card-content",0),t._UZ(13,"mat-card-actions"),t.qZA(),t.YNc(14,vt,2,0,"ng-template",null,4,t.W1O),t.BQk()}if(2&o){const e=a.ngIf;t.xp6(7),t.Oqu(null==e.selectedBlogPost?null:e.selectedBlogPost.title),t.xp6(1),t.Q6J("src",null==e.selectedBlogPost?null:e.selectedBlogPost.image,t.LSH),t.xp6(3),t.Oqu(null==e.selectedBlogPost?null:e.selectedBlogPost.text),t.xp6(1),t.Q6J("ngIf",null==e.selectedBlogPost||null==e.selectedBlogPost.tags?null:e.selectedBlogPost.tags.length)}}let bt=(()=>{class o{constructor(e){this.blogDataService=e,this.onGoBackAction=new t.vpe,this.data$=this.blogDataService.data$}onGoBack(){this.onGoBackAction.emit()}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-blog-post-detail"]],outputs:{onGoBackAction:"onGoBackAction"},decls:2,vars:3,consts:[[4,"ngIf"],[1,"text-right"],["mat-stroked-button","",3,"click"],["mat-card-image","","alt","",3,"src"],["spinner",""],[4,"ngFor","ngForOf"],[1,"col"]],template:function(e,n){1&e&&(t.YNc(0,Ct,16,4,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.data$))},dependencies:[p.sg,p.O5,D.lW,f.a8,f.dk,f.dn,f.n5,f.hq,f.G2,B.qn,B.HS,k.Ou,p.Ov],styles:[".text-right[_ngcontent-%COMP%]{text-align:right}"]}),o})();var g=l(4006),O=l(9549),Et=l(4144),z=l(9521),H=l(7957),It=l(3238);const xt=["tagInput"];function Ot(o,a){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.hij(" ",n.allTags[e].name," ")}}function Ut(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-chip",9),t.NdJ("removed",function(){const s=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.remove(s))}),t.YNc(1,Ot,2,1,"ng-container",10),t.TgZ(2,"button",11)(3,"mat-icon"),t._uU(4,"cancel"),t.qZA()()()}if(2&o){const e=a.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.allTags[e])}}function Ft(o,a){if(1&o&&(t.TgZ(0,"mat-option",12),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}let Zt=(()=>{class o{constructor(){this.onAddTagAction=new t.vpe,this.onRemoveTagAction=new t.vpe,this.onCreateNewTag=new t.vpe,this.separatorKeysCodes=[z.K5,z.OC],this.tagCtrl=new g.NI(""),this.filteredTags=this.tagCtrl.valueChanges.pipe((0,L.O)(null),(0,T.U)(e=>e?this._filter(e):Object.values(this.allTags).slice()))}add(e){const n=(e.value||"").trim();n&&this.onCreateNewTag.emit(n),e.chipInput.clear(),this.tagCtrl.setValue(null)}remove(e){this.onRemoveTagAction.emit(e),console.log("remove ",e)}selected(e){!this.tags.includes(e.option.value)&&this.onAddTagAction.emit(e.option.value),console.log("selected ",e.option.value)}_filter(e){if("string"==typeof e){console.log("filter ",e);const n=e.toLowerCase();return Object.values(this.allTags).filter(s=>{const c=this.tags.find(u=>u===s.id);return s.name.toLowerCase().includes(n)&&!c})}return[]}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-blog-post-edit-tags"]],viewQuery:function(e,n){if(1&e&&t.Gf(xt,5),2&e){let i;t.iGM(i=t.CRH())&&(n.tagInput=i.first)}},inputs:{tags:"tags",allTags:"allTags"},outputs:{onAddTagAction:"onAddTagAction",onRemoveTagAction:"onRemoveTagAction",onCreateNewTag:"onCreateNewTag"},decls:12,vars:8,consts:[["appearance","outline"],["aria-label","Tags selection"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],["placeholder","New tag...",3,"formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["tagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"removed"],[4,"ngIf"],["matChipRemove",""],[3,"value"]],template:function(e,n){if(1&e&&(t.TgZ(0,"mat-form-field",0)(1,"mat-label"),t._uU(2,"Post's tags"),t.qZA(),t.TgZ(3,"mat-chip-list",1,2),t.YNc(5,Ut,5,1,"mat-chip",3),t.TgZ(6,"input",4,5),t.NdJ("matChipInputTokenEnd",function(s){return n.add(s)}),t.qZA()(),t.TgZ(8,"mat-autocomplete",6,7),t.NdJ("optionSelected",function(s){return n.selected(s)}),t.YNc(10,Ft,2,2,"mat-option",8),t.ALo(11,"async"),t.qZA()()),2&e){const i=t.MAs(4),s=t.MAs(9);t.xp6(5),t.Q6J("ngForOf",n.tags),t.xp6(1),t.Q6J("formControl",n.tagCtrl)("matAutocomplete",s)("matChipInputFor",i)("matChipInputSeparatorKeyCodes",n.separatorKeysCodes),t.xp6(4),t.Q6J("ngForOf",t.lcZ(11,6,n.filteredTags))}},dependencies:[p.sg,p.O5,H.XC,H.ZL,It.ey,B.qn,B.HS,B.oH,B.qH,y.Hw,O.KE,O.hX,g.Fj,g.JJ,g.oH,p.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%;padding:1rem}"]}),o})();const Gt=function(){return[]};let Lt=(()=>{class o{constructor(e){this.blogDataService=e,this.onGoBackAction=new t.vpe,this.onFormSavedAction=new t.vpe,this.postForm=new g.cw({title:new g.NI("",[g.kI.required,g.kI.minLength(1),g.kI.maxLength(150)]),detail:new g.NI("",[g.kI.required,g.kI.minLength(1),g.kI.maxLength(300)]),text:new g.NI("",[g.kI.required,g.kI.minLength(1),g.kI.maxLength(3e3)])})}set post(e){e&&this.postForm.setValue({title:e.title,detail:e.detail,text:e.text?e.text:""}),this._post=e}get post(){return this._post}onCreateNewTagRequested(e){this.blogDataService.createNewTag(e)}onTagAddedToBlogPost(e){this.post&&this.blogDataService.addTagToBlogPost(e,this.post.id)}onSubmit(e){if(e&&this.post){const n={...this.post,title:e.value.title,detail:e.value.detail,text:e.value.text};this.onFormSavedAction.emit(n)}}onGoBack(){this.onGoBackAction.emit()}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-blog-post-edit"]],inputs:{allTags:"allTags",post:"post"},outputs:{onGoBackAction:"onGoBackAction",onFormSavedAction:"onFormSavedAction"},decls:16,vars:5,consts:[[3,"formGroup","ngSubmit"],["appearance","outline"],["matInput","","formControlName","title"],["matInput","","formControlName","detail"],["matInput","","formControlName","text","rows","20"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"allTags","tags","onCreateNewTag","onAddTagAction"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return n.onSubmit(n.postForm)}),t.TgZ(1,"mat-form-field",1)(2,"mat-label"),t._uU(3,"Title"),t.qZA(),t._UZ(4,"input",2),t.qZA(),t.TgZ(5,"mat-form-field",1)(6,"mat-label"),t._uU(7,"Detail"),t.qZA(),t._UZ(8,"textarea",3),t.qZA(),t.TgZ(9,"mat-form-field",1)(10,"mat-label"),t._uU(11,"Text"),t.qZA(),t._UZ(12,"textarea",4),t.qZA(),t.TgZ(13,"button",5),t._uU(14,"Save"),t.qZA()(),t.TgZ(15,"app-blog-post-edit-tags",6),t.NdJ("onCreateNewTag",function(s){return n.onCreateNewTagRequested(s)})("onAddTagAction",function(s){return n.onTagAddedToBlogPost(s)}),t.qZA()),2&e&&(t.Q6J("formGroup",n.postForm),t.xp6(13),t.Q6J("disabled",n.postForm.invalid),t.xp6(2),t.Q6J("allTags",n.allTags)("tags",n.post?n.post.tags:t.DdM(4,Gt)))},dependencies:[D.lW,O.KE,O.hX,Et.Nt,g._Y,g.Fj,g.JJ,g.JL,g.sg,g.u,Zt],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%;padding:0 1rem}button[_ngcontent-%COMP%]{margin:0 1rem}mat-form-field[_ngcontent-%COMP%]:first-of-type{padding-top:.5rem}"]}),o})();function $t(o,a){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"article"),t.qZA(),t._uU(2," Detail "))}function Dt(o,a){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"edit"),t.qZA(),t._uU(2," Edit "))}function yt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-tab-group",1)(2,"mat-tab"),t.YNc(3,$t,3,0,"ng-template",2),t.TgZ(4,"app-blog-post-detail",3),t.NdJ("onGoBackAction",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.goBack())}),t.qZA()(),t.TgZ(5,"mat-tab"),t.YNc(6,Dt,3,0,"ng-template",2),t._UZ(7,"app-blog-post-edit",4),t.qZA()(),t.BQk()}if(2&o){const e=a.ngIf;t.xp6(1),t.Q6J("selectedIndex",e.selectedBlogPostMode),t.xp6(6),t.Q6J("post",e.selectedBlogPost)("allTags",e.tagsById)}}const Rt=[{path:"",component:Bt,outlet:"sidebar"},{path:"",component:_t},{path:":blogPostId",component:(()=>{class o{constructor(e,n){this.blogDataService=e,this.router=n,this.tabs={tab1:{tabId:1,tabTitle:"Detail"},tab2:{tabId:2,tabTitle:"Edit"}},this.data$=this.blogDataService.data$}onTabIdChanged(e){console.log(e)}goBack(){this.blogDataService.onSelectBlogPost(),this.router.navigate(["/blog"])}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A),t.Y36(E.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-blog-post"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"selectedIndex"],["mat-tab-label",""],[3,"onGoBackAction"],[3,"post","allTags"]],template:function(e,n){1&e&&(t.YNc(0,yt,8,3,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.data$))},dependencies:[p.O5,y.Hw,N.SP,N.uD,N.uX,bt,Lt,p.Ov],styles:["mat-icon[_ngcontent-%COMP%]{margin-right:1rem}"],changeDetection:0}),o})()}];let Nt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[E.Bz.forChild(Rt),E.Bz]}),o})();var v=l(5577),U=l(262),j=l(9300),Q=l(6943);let K=(()=>{class o{constructor(e){this.http=e,this.paths={tag:"tag",blog:"blog"}}reqUrl(e){let n="";return e&&(n+=e),n}getTagsList(){return this.http.Get(this.reqUrl(this.paths.tag))}createTag(e){return this.http.Post(this.reqUrl(`${this.paths.tag}/`),e)}updateTag(e){return this.http.Put(this.reqUrl(`${this.paths.tag}/${e.id}`),e)}addTagToBlogPost(e,n){return this.http.Put(this.reqUrl(`${this.paths.blog}/${n}/add_tag/${e}/`))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(b.O))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})(),Qt=(()=>{class o{constructor(e,n,i){this.actions$=e,this.blogService=n,this.blogCS=i,this.blogModuleInitialFetchEffect$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.blog_module_init),(0,T.U)(()=>r.tags_list_request()))),this.fetchTagsListEffect$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.tags_list_request),(0,v.z)(()=>this.blogService.getTagsList().pipe((0,T.U)(s=>{const c={};return s.length&&s.forEach(u=>c[u.id]=u),r.tags_list_response(s,c,s?.length?s.length:0)}),(0,U.K)(s=>(0,S.of)(r.tags_list_failure(s))))))),this.createNewTagEffect$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.create_tag_request),(0,v.z)(({newTag:s})=>this.blogService.createTag(s).pipe((0,v.z)(c=>[r.create_tag_response(c),r.tags_list_request()]),(0,U.K)(c=>(0,S.of)(r.create_tag_failure(c))))))),this.addTagToBlogPostEffect$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.add_tag_to_blogpost_request),(0,v.z)(({tagId:s,blogPostId:c})=>this.blogService.addTagToBlogPost(s,c).pipe((0,v.z)(u=>[r.add_tag_to_blogpost_response(u),this.blogCS.dispatchCSBlogPostsFetchForEffect()]),(0,U.K)(u=>(0,S.of)(r.add_tag_to_blogpost_failure(u))))))),this.addNewlyCreatedTagToSelectedBlogPostEffect$=(0,d.GW)(()=>(0,x.a)([this.actions$.pipe((0,d.l4)(r.create_tag_response)),this.actions$.pipe((0,d.l4)(Q.tE),(0,T.U)(s=>{const{payload:{routerState:{params:c}}}=s;return c.blogPostId}))]).pipe((0,T.U)(([{item:s},c])=>r.add_tag_to_blogpost_request(s.id,c)))),this.updateTagEffect$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(r.update_tag_request),(0,v.z)(({proposedTag:s})=>this.blogService.updateTag(s).pipe((0,T.U)(c=>r.update_tag_response(c)),(0,U.K)(c=>(0,S.of)(r.update_tag_failure(c))))))),this.fetchBlogPostByIdBasedOnRouterEffect$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(Q.tE),(0,j.h)(s=>{const{payload:{routerState:{url:c,params:u}}}=s;return c.startsWith("/blog/")&&u.blogPostId}),(0,T.U)(s=>{const{payload:{routerState:{params:c}}}=s;return c.blogPostId}),(0,T.U)(s=>this.blogCS.dispatchCSBlogPostFetchByIdForEffect(+s)))),this.refetchBlogPostsBasedOnRouteEffect$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(Q.tE),(0,j.h)(s=>{const{payload:{routerState:{url:c}}}=s;return"/blog"===c||"/blog/"===c}),(0,T.U)(()=>this.blogCS.dispatchCSBlogPostsFetchForEffect())))}ngrxOnInitEffects(){return r.blog_module_init()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(d.eX),t.LFG(K),t.LFG(C))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})(),wt=(()=>{class o{constructor(e,n,i){e.registerMetadataMap(F.b),n.registerService("BlogPost",i)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(h.f0),t.LFG(h.sP),t.LFG(Y))},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[b.O,K,{provide:"apiUrl",useValue:"https://endevel-task.doc.endevel.cz/"},{provide:h.hR,useClass:q},C,A],imports:[p.ez,W.m,Nt,m.Aw.forFeature(P),d.sQ.forFeature([Qt]),g.u5,g.UX]}),o})()}}]);